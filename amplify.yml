version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "🔄 Starting Amplify build process..."
        - echo "🧹 Aggressively clearing all caches..."
        - rm -rf .next node_modules/.cache .cache
        - npm cache clean --force
        - echo "📦 Installing dependencies..."
        - npm ci --no-cache
        - echo "✅ Dependencies installed successfully"
    build:
      commands:
        - echo "🔨 Building Next.js application..."
        - echo "🏗️ Starting build with clean slate..."
        - npm run build
        - echo "✅ Build completed successfully"
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths: []
