version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "ğŸ”„ Starting Amplify build process..."
        - echo "ğŸ§¹ Aggressively clearing all caches..."
        - rm -rf .next node_modules/.cache .cache
        - npm cache clean --force
        - echo "ğŸ“¦ Installing dependencies..."
        - npm ci --no-cache
        - echo "âœ… Dependencies installed successfully"
    build:
      commands:
        - echo "ğŸ”¨ Building Next.js application..."
        - echo "ğŸ—ï¸ Starting build with clean slate..."
        - npm run build
        - echo "âœ… Build completed successfully"
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths: []
